# 电学模拟工具 使用说明

一个基于 Web 的交互式电路模拟器，支持多种电子元器件的拖放、连线和实时仿真。

---

## 目录

1. [快速开始](#快速开始)
2. [界面介绍](#界面介绍)
3. [元器件说明](#元器件说明)
4. [基本操作](#基本操作)
5. [画布导航](#画布导航)
6. [电路仿真](#电路仿真)
7. [快捷键](#快捷键)
8. [常见问题](#常见问题)

---

## 快速开始

1. 用浏览器打开 `index.html` 文件
2. 从左侧工具箱拖拽元器件到画布
3. 点击元器件端子并拖动到另一个端子来连线
4. 点击 **运行** 按钮开始仿真

---

## 界面介绍

```
┌─────────────────────────────────────────────────────────────┐
│                        工具栏                                │
│  [运行] [停止] [清空] [导出] [导入]                          │
├──────────┬────────────────────────────────┬─────────────────┤
│          │                                │                 │
│  工具箱  │           画布区域             │    属性面板     │
│          │                                │                 │
│  电源    │     (拖放元器件到这里)         │   选中元器件    │
│  电阻    │                                │   的属性设置    │
│  滑动变阻器│                              │                 │
│  灯泡    │                                │   显示设置      │
│  电容    │                                │   □ 显示电流    │
│  电动机  │                                │   □ 显示电压    │
│  开关    │                                │   □ 显示功率    │
│  电流表  │                                │                 │
│  电压表  │                                │                 │
│          │                                │                 │
├──────────┴────────────────────────────────┴─────────────────┤
│  状态栏                    100%              模拟: 停止      │
└─────────────────────────────────────────────────────────────┘
```

---

## 元器件说明

### ⚡ 电源 (PowerSource)
- **功能**：提供电路的电动势
- **参数**：
  - 电压 (V)：1V - 100V，默认 10V
  - 内阻 (Ω)：0Ω - 100Ω，默认 0Ω
- **端子**：正极（+）和负极（-）

### 🔧 电阻 (Resistor)
- **功能**：限制电流流动
- **参数**：
  - 电阻值 (Ω)：1Ω - 10MΩ，默认 100Ω
- **端子**：两端等效

### 📏 滑动变阻器 (Rheostat)
- **功能**：可调节的电阻器，三端子设计
- **参数**：
  - 最大电阻 (Ω)：1Ω - 10MΩ，默认 100Ω
  - 滑动位置：0% - 100%
- **端子**：
  - 上端子 (A)
  - 中间滑动端 (P) - 滑块位置
  - 下端子 (B)
- **连接方式**：
  - A-P：电阻 = 位置% × 最大电阻
  - P-B：电阻 = (1-位置%) × 最大电阻
  - A-B：电阻 = 最大电阻

### 💡 灯泡 (Bulb)
- **功能**：将电能转化为光能，显示发光效果
- **参数**：
  - 额定电压 (V)：默认 6V
  - 额定功率 (W)：默认 3W
- **特性**：根据实际功率显示亮度变化

### ⚡ 电容 (Capacitor)
- **功能**：储存电荷
- **参数**：
  - 电容值 (F)：默认 100μF
- **特性**：仿真中显示充放电状态

### ⚙️ 电动机 (Motor)
- **功能**：将电能转化为机械能
- **参数**：
  - 额定电压 (V)：默认 6V
  - 额定功率 (W)：默认 3W
- **特性**：根据功率显示转动动画

### 🔘 开关 (Switch)
- **功能**：控制电路通断
- **参数**：
  - 状态：开/关
- **操作**：双击切换开关状态，或在属性面板中切换

### 📊 电流表 (Ammeter)
- **功能**：测量流经的电流
- **参数**：
  - 内阻 (Ω)：0.001Ω - 10Ω，默认 0.01Ω
- **显示**：实时显示电流读数
- **注意**：应串联在电路中

### 📈 电压表 (Voltmeter)
- **功能**：测量两端电压
- **参数**：
  - 内阻 (Ω)：1kΩ - 10MΩ，默认 1MΩ
- **显示**：实时显示电压读数
- **注意**：应并联在被测元件两端

---

## 基本操作

### 添加元器件
1. 在左侧工具箱中找到需要的元器件
2. **拖拽**元器件图标到画布上的目标位置
3. 释放鼠标，元器件将吸附到网格

### 选择元器件
- **单击**元器件即可选中
- 选中的元器件会显示蓝色边框
- 右侧属性面板会显示该元器件的属性

### 移动元器件
- **拖拽**元器件到新位置
- 元器件会自动吸附到 20px 网格
- 连接的导线会自动跟随移动

### 旋转元器件
- **选中**元器件后按 **R** 键
- 每次旋转 90°

### 删除元器件
- **选中**元器件后按 **Delete** 或 **Backspace** 键
- 连接到该元器件的导线会自动删除

### 连接导线
1. **点击**一个元器件的端子（小圆圈）
2. **拖动**到另一个元器件的端子
3. **释放**鼠标完成连接
4. 导线会自动生成合理的折线路径

### 编辑导线
- **拖动**导线上的控制点（小方块）调整路径
- **双击**导线编辑其属性

### 删除导线
- **单击**选中导线（变为蓝色）
- 按 **Delete** 或 **Backspace** 键删除

### 编辑属性
- **双击**元器件打开属性对话框
- 或**选中**元器件后在右侧属性面板中编辑
- 修改后点击**确定**应用更改

---

## 画布导航

### 平移画布
- **右键拖动**：在画布任意位置按住右键拖动即可平移视图
- **中键拖动**：按住鼠标中键拖动也可平移

### 缩放画布
- **滚动鼠标滚轮**：放大/缩小
  - 向上滚动：放大
  - 向下滚动：缩小
- 缩放范围：25% - 400%
- 缩放以鼠标位置为中心

### 重置视图
- 按 **H** 键：重置到默认视图（100%，居中）
- 点击状态栏的**缩放百分比**：重置视图

---

## 电路仿真

### 开始仿真
1. 搭建完成电路后，点击工具栏的 **运行** 按钮
2. 或确保电路形成闭合回路

### 仿真显示
- **电流方向**：导线上的箭头动画
- **电流大小**：元器件上方显示 I = x.xx A
- **电压值**：元器件上方显示 U = x.xx V
- **功率值**：可选显示 P = x.xx W
- **灯泡亮度**：根据功率显示不同亮度
- **电动机转速**：根据功率显示转动动画
- **仪表读数**：电流表/电压表显示实时读数

### 显示设置
在右侧属性面板的**显示设置**区域：
- ☑️ 显示电流 (I)
- ☑️ 显示电压 (U)
- ☐ 显示功率 (P)

### 停止仿真
点击工具栏的 **停止** 按钮

---

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Delete` / `Backspace` | 删除选中的元器件或导线 |
| `R` | 旋转选中的元器件 90° |
| `H` | 重置画布视图 |
| `右键拖动` | 平移画布 |
| `滚轮` | 缩放画布 |
| `Escape` | 关闭对话框 / 取消连线 |
| `双击元器件` | 打开属性编辑对话框 |
| `双击开关` | 切换开关状态 |

---

## 文件操作

### 导出电路
1. 点击工具栏的 **导出** 按钮
2. 浏览器会下载一个 `.json` 文件
3. 文件包含所有元器件和连线信息

### 导入电路
1. 点击工具栏的 **导入** 按钮
2. 选择之前导出的 `.json` 文件
3. 电路将被加载到画布上

### 清空电路
1. 点击工具栏的 **清空** 按钮
2. 确认后将删除所有元器件和导线

---

## 常见问题

### Q: 为什么仿真没有反应？
**A:** 请检查：
1. 电路是否形成闭合回路
2. 是否有电源
3. 开关是否闭合
4. 元器件参数是否合理（如电阻不能为 0）

### Q: 为什么灯泡不亮？
**A:** 请检查：
1. 电路是否连接正确
2. 电压是否足够
3. 电路中是否有断开的开关

### Q: 滑动变阻器怎么接？
**A:** 滑动变阻器有三个端子：
- 如果需要可调电阻，接 A-P 或 P-B
- 如果需要固定全电阻，接 A-B
- 调节滑块位置改变电阻值

### Q: 电流表/电压表怎么接？
**A:** 
- **电流表**：串联在电路中，测量流经的电流
- **电压表**：并联在被测元件两端，测量电压差

### Q: 怎么调整导线路径？
**A:** 
- 选中导线后，拖动导线上的控制点（小方块）
- 可以添加多个拐点让导线绕过其他元器件

### Q: 缩放后元器件位置不对？
**A:** 按 **H** 键重置视图到默认状态

---

## 技术信息

- **仿真算法**：改进节点分析法 (MNA)
- **更新频率**：60 FPS
- **支持浏览器**：Chrome, Firefox, Edge, Safari (现代版本)
- **无需安装**：纯前端实现，直接打开 HTML 即可使用

---

## 版本信息

**当前版本**：1.0.0

**更新日志**：
- 支持 9 种基本元器件
- 实时电路仿真
- 画布平移和缩放
- 电路导入/导出
- 可视化电流和电压显示

---

> 💡 **提示**：建议使用 Chrome 或 Firefox 浏览器以获得最佳体验。
